function M = poly3mat(V, order)
% Returns the 3rd order polynomial matrix of v

if order == 3
M= [ones(size(V,1),1), ...
        ...
        V(:,1), V(:,2), V(:,3), ...
        ...
        V(:,1).*V(:,1), V(:,1).*V(:,2), V(:,1).*V(:,3), ...
        V(:,2).*V(:,2), V(:,2).*V(:,3), V(:,3).*V(:,3), ...
        ...
        V(:,1).*V(:,1).*V(:,1), V(:,1).*V(:,1).*V(:,2), V(:,1).*V(:,1).*V(:,3),...
        V(:,1).*V(:,2).*V(:,2), V(:,1).*V(:,2).*V(:,3), V(:,1).*V(:,3).*V(:,3), ...
        V(:,2).*V(:,2).*V(:,2), V(:,2).*V(:,2).*V(:,3), V(:,2).*V(:,3).*V(:,3), ...
        V(:,3).*V(:,3).*V(:,3)];
end


if order == 2
M= [ones(size(V,1),1), ...
        ...
        V(:,1), V(:,2), V(:,3), ...
        ...
        V(:,1).*V(:,1), V(:,1).*V(:,2), V(:,1).*V(:,3), ...
        V(:,2).*V(:,2), V(:,2).*V(:,3), V(:,3).*V(:,3)];
end

if order == 1
M= [ones(size(V,1),1), ...
        V(:,1), V(:,2), V(:,3)];    
end

    