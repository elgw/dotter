#include "string.h"
#include "math.h"

void gaussianInt2(double * GI, double * mu, double * sigma, int w)
{

double mux = mu[0];
double muy = mu[1];

  double * erfx = malloc((w+1)*sizeof(double));
  double * erfy = malloc((w+1)*sizeof(double));

  double x0 = -(double) w/2;
  double y0 = -(double) w/2;
  for(int kk=0; kk<w+1; kk++)
  {
  //  printf("x0: %f y0: %f \n", x0, y0);
    erfx[kk] = .5*(1+erf((x0++-mux)/sqrt(2)/sigma[0]));
    erfy[kk] = .5*(1+erf((y0++-muy)/sqrt(2)/sigma[0]));
  }

for(int xx=0; xx<w; xx++)
  for(int yy =0; yy<w; yy++)
    {
      double one   = erfx[xx+1]*erfy[yy];
      double two   = erfx[xx+1]*erfy[yy+1];
      double three = erfx[xx]*erfy[yy];
      double four  = erfx[xx]*erfy[yy+1];
      GI[xx+w*yy]=two-one-four+three;
    }

  free(erfy);
  free(erfx);
}


