#include <string.h>
#include <stdio.h>
#include <math.h>
#include "mex.h"
#include "conv1.h"



#ifndef verbose
#define verbose 1
#endif

void mexFunction(int nlhs, mxArray *plhs[],int nrhs, const mxArray *prhs[]) 
{


 if (! (nrhs==4)) {
    mexErrMsgTxt("There should be four inputs");
  }

  double * V = (double *) mxGetPr(prhs[0]);
  int VnDim = mxGetNumberOfDimensions(prhs[0]);

if(VnDim != 3)
  mexErrMsgTxt("Input volume should be 3d");

  double * Kx = NULL;
  double * Ky = NULL;
  double * Kz = NULL;
  size_t nKx = 0;
  size_t nKy = 0;
  size_t nKz = 0;

if(mxGetNumberOfElements(prhs[1])>0){
    Kx = (double *) mxGetPr(prhs[1]);
    nKx = mxGetNumberOfElements(prhs[1]);
    }
if(mxGetNumberOfElements(prhs[2])>0) {
    Ky = (double *) mxGetPr(prhs[2]);
    nKy = mxGetNumberOfElements(prhs[3]);
    }
 if(mxGetNumberOfElements(prhs[3])>0) {
    Kz = (double *) mxGetPr(prhs[3]);
    nKz = mxGetNumberOfElements(prhs[3]);
    }

   double * W = mxCreateNumericArray(VnDim, Vdim, mxDOUBLE_CLASS, nxREAL);
memcpy(V, W, Vnel*sizeof(double));

conv1_3(W, M, N, P, Kx, nKx, Ky, nKy, Kz, nKz);

}


